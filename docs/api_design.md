# API Design & Data Models

## Data Models

### `Submission`
```json
{
  "id": "uuid",
  "student_name": "string",
  "image_url": "url",
  "status": "PROCESSING | REVIEW_REQUIRED | COMPLETED",
  "extracted_data": [
    {
      "question_no": "1a",
      "text": "The mitochondria is the powerhouse..."
    }
  ]
}
```

### `Rubric` (Generated by Model Answer Agent)
```json
{
  "exam_id": "uuid",
  "questions": [
    {
      "id": "1a",
      "max_marks": 5,
      "key_points": ["mitochondria", "atp production", "energy"],
      "partial_credit_rules": "Award 1 mark for mentioning ATP."
    }
  ]
}
```

## Endpoints

### 1. Vision & OCR Agent
**POST** `/api/v1/scan`
- **Purpose**: Uploads and pre-processes the image.
- **Input**: `Multipart/Form-Data` (Image)
- **Process**:
    1. `VisionAgent` detects edges and crops.
    2. `OCRAgent` extracts text.
- **Output**:
```json
{
  "submission_id": "123",
  "detected_text": "...",
  "confidence": 0.85
}
```

### 2. Model Answer Agent
**POST** `/api/v1/rubric/generate`
- **Purpose**: Create a grading rubric from a teacher's uploaded answer key.
- **Input**: Text or PDF file.
- **Output**: `Rubric` JSON object.

### 3. Evaluation Agent
**POST** `/api/v1/evaluate/{submission_id}`
- **Purpose**: Grade the submission against the rubric.
- **Input**:
```json
{
  "rubric_id": "rub_456"
}
```
- **Output**:
```json
{
  "status": "COMPLETED",
  "total_score": 15,
  "results": [
    {
      "question_id": "1a",
      "score": 4,
      "feedback": "Missed the point about cellular respiration.",
      "annotation_coordinates": [100, 200, 300, 400]
    }
  ]
}
```
